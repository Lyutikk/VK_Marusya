[![Typing SVG](https://readme-typing-svg.herokuapp.com?color=%2336BCF7&lines=Voice+assistant+Marusya)](https://git.io/typing-svg)

<h1 align="center">Решение команды GrowAi на хакатоне СКФО Цифровой прорыв: <i>"Маруся не отвечает на реплики из телевизора"</i></h1>

  <p align="center"><img src="https://grow-ai-marusya-vk-digital.hf.space/media/d5c5f03764cfe8f85490c4edca900b35975b1bd5f4971f4e117e81ce.jpeg" width="800" height="600"></p>
  <h1 align="center"><a href="https://github.com/Lyutikk/VK_Marusya/blob/master/VK_Marusya_GrowAi.pdf">Презентация выступления</a></h1>
  
  <h2>Краткое описание кейса</h2>
  <p>Голосовые помощники становятся неотъемлемой частью нашей жизни — они помогают не только нам, но и пользователям разного возраста. Например, одной 
    из ключевых аудиторий для голосового помощника от VK — Маруси являются дети — они общаются с ней как с другом, учатся через нее и получают полезную информацию. 
    Зачастую детская коммуникация с детскими технологиями специфична.
  </p>
  
  <h2>Проблематика</h2>
  <p>В некоторых случаях вместо фразы пользователя, Маруся может услышать фразу из телевизора, который работает фоном, и ответить на неё, что не очень нравится 
    пользователям. К тому же большинство ответов на произвольный набор слов будут нерелевантны.
  </p>
  
  <h2>Решение</h2>
  <p>Решение кейса представляет собой модель, которая будет понимать, что фраза не от пользователя, а от телевизора. Тогда Маруся смогла бы не отвечать на такие фразы.</p>
  
  <h2>Данные</h2>
  <p>Данные содержат в себе 3 столбца. В первом столбце содержится фраза для которой необходимо сделать предсказание, является ли она обращением к Марусе или нет. 
    Второй столбец содержит в себе контекст диалога с Марусей. Данный диалог предшествовал целевой фразе(предсказание делается именно для одной конкретной фразы из 
    первого столбца). Если диалог заполнен пропусками, то диалога с Марусей до нее не было, либо человек молчал. Третий столбец содержит в себе целевую переменную. 
    1 – если фраза не обращена к Марусе, 0 – если фраза предназначалась ей. 
  </p>
  
  <h2>Формат датасета:</h2>
  <p><b>текст фразы пользователя  \t контекст общения с Марусей \t метка </b></p>
  <p>‘\t’ - разделитель</p>
  
  <h2>Для запуска обучения:</h2>
    <code>python3 train.py --model roberta --name roberta_test --epochs 5 --batch 8 --optimizer adam --scheduler cosine --device 4</code>
  <h2>Для запуска обучения на фолдах выполните:</h2>
    <code>python3 train_cv.py --model roberta --name roberta_test --epochs 5 --batch 8 --optimizer adam --scheduler cosine --device 4</code>
  <h2>Для запуска обучения с семплированием выполните:</h2>
    <code>python3 train_sampled.py --model roberta --name roberta_test --epochs 5 --batch 8 --optimizer adam --scheduler cosine --device 4</code>
  <h2>У данных файлов существуют следующие флаги:</h2>
    <ul>
        <li>model - архитектура модели (bert, t5, roberta)</li>
        <li>name - название модели</li>
        <li>device - количество девайсов GPU</li>
        <li>epochs - количество эпох</li>
        <li>batch - размер батча</li>
        <li>optimizer - оптимизатор (adam, adafactor, sgd)</li>
        <li>scheduler - шедулер (adafactor, cosine, linear)</li>
        <li>seeds - фиксировать сид</li>
        <li>track - отслеживать лосс или метрику</li>
        <li>accum - аккумуляция батча</li>
        <li>loss_type - тип лосса (ce, bce, softmarginloss)</li>
        <li>add_feat - добавить дополнительные вещественные фичи</li>
        <li>add_resp - добавить токен</li>
        <li>rewrite_data - переписать данные</li>
   </ul>
   <h2></h2>
   <p>В папку <b>checkpoints</b> грузятся чекпоины.</p>
   <p>В папке <b>notebooks</b> - рабочие ноутбуки со всеми функциями.</p>
   <p><b>В test_data_predict.ipynb</b> - находится предикшен тестовой выборки.</p>
   <p><b>model_wrapper.py, model_factory.py, clfs.py</b> - это цикл обучения, создание модели, код классификаторов.</p>
   </p>Загрузить модели и распаковать, чтобы сделать тестовый предикшен, можно по <a href="https://drive.google.com/file/d/1dA-jnQFDNSY3Oi4tUSFBCHGQl0soKlX2/view?usp=share_link">ССЫЛКЕ</a></p>
